<h2 style="margin:0 0 12px">Proyectos</h2>
<p class="muted" style="color:var(--ink-500); margin:0 0 16px">
  Iniciativas activas que mejoran la eficiencia y la trazabilidad.
</p>

<div class="grid">
  <div class="col-4">
    <div class="card">
      <div class="tag" style="margin-bottom:8px">
        <span class="material-symbols-rounded">sync_saved_locally</span> Implementado
      </div>
      <h3>Proyecto Logística</h3>
      <p>Automatización integral de peticiones de personal, asignación de equipos y posiciones en Creatio, conexión bidireccional con MyPlanner y reporting end‑to‑end en Power BI. Firma digital en entregas/devoluciones.</p>
      <div class="meta">Impacto: +9.000 firmas digitales · −40% en tiempos E/D · Ahorro recepciones >1k€/año</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <a class="btn" href="#" onclick="alert('Placeholder: Creatio'); return false;">
          <span class="material-symbols-rounded">hub</span> Creatio
        </a>
        <a class="btn" href="#" onclick="alert('Placeholder: PBI'); return false;">
          <span class="material-symbols-rounded">monitoring</span> Power BI
        </a>
      </div>
    </div>
  </div>

  <div class="col-4">
    <div class="card">
      <div class="tag" style="margin-bottom:8px">
        <span class="material-symbols-rounded">sync_saved_locally</span> Implementado
      </div>
      <h3>Reclamaciones de nómina – Pago TT</h3>
      <p>Aplicativo en Creatio para gestionar reclamaciones de abono por teletrabajo: tramitación por estados, notificaciones automáticas e informes en Excel.</p>
      <div class="meta">Flujo completo en Creatio · Descarga/Upload .xlsx · Seguimiento y resultados</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <a class="btn" id="btnReclamaciones" href="#">
          <span class="material-symbols-rounded">open_in_new</span> Abrir
        </a>
        <a class="btn" href="https://docs.google.com/document/d/1MOIzlfmbo72iq6eR-LFAjTjA_9nFt263/edit?usp=sharing&ouid=105869342267995031811&rtpof=true&sd=true" target="_blank">
          <span class="material-symbols-rounded">description</span> Documentación
        </a>
      </div>
    </div>
  </div>

  <div class="col-4">
    <div class="card">
      <div class="tag" style="margin-bottom:8px">
        <span class="material-symbols-rounded">sync_saved_locally</span> Implementado
      </div>
      <h3>Bolsa de Horas</h3>
      <p>Aplicación para el control y compensación de horas. Evolutivo fuera de objetivos del proyecto principal.</p>
      <div class="meta">Estado: En uso · Integración con Apps Script/Sheets</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <a class="btn" href="#" onclick="alert('Placeholder: Web/App'); return false;">
          <span class="material-symbols-rounded">apps</span> Acceder
        </a>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card">
      <div class="tag" style="margin-bottom:8px">
        <span class="material-symbols-rounded">sync_saved_locally</span> Implementado
      </div>
      <h3>Reserva de Salas de Formación</h3>
      <p>Aplicación web en Apps Script para gestionar la reserva de salas de formación: calendario centralizado, control de disponibilidad y flujos de aprobación por rol.</p>
      <div class="meta">Estado: En uso · Integración con Calendar/Sheets · Recordatorios automáticos y logs de auditoría</div>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <a class="btn" href="#" onclick="alert('Placeholder: Reserva Salas'); return false;">
          <span class="material-symbols-rounded">event</span> Acceder
        </a>
      </div>
    </div>
  </div>

  <div class="col-4">
    <div class="card">
      <div class="tag" style="margin-bottom:8px">
        <span class="material-symbols-rounded">labs</span> Piloto
      </div>
      <h3>Planificador de posiciones</h3>
      <p>Previsión de posiciones y equipamiento basada en históricos y presupuesto. Indicadores en Power BI y validación con MyPlanner.</p>
      <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
        <a class="btn" href="#" onclick="alert('Placeholder: MyPlanner'); return false;">
          <span class="material-symbols-rounded">calendar_clock</span> MyPlanner
        </a>
        <a class="btn" href="#" onclick="alert('Placeholder: Docs'); return false;">
          <span class="material-symbols-rounded">description</span> Documentación
        </a>
      </div>
    </div>
  </div>

  <div class="col-12">
    <div class="card list">
      <div class="list-item">
        <div>
          <strong>Reclamaciones Pago TT en Creatio</strong>
          <div class="meta">Flujo por estados · Notificaciones · Informes Excel</div>
        </div>
        <a class="btn" href="#" onclick="alert('Placeholder'); return false;">
          <span class="material-symbols-rounded">open_in_new</span> Ver flujo
        </a>
      </div>
      <div class="list-item">
        <div>
          <strong>Renovaciones tácitas</strong>
          <div class="meta">Ahorro estimado anual &gt; 21k €</div>
        </div>
        <a class="btn" href="#" onclick="alert('Placeholder'); return false;">
          <span class="material-symbols-rounded">open_in_new</span> Ver detalle
        </a>
      </div>
      <div class="list-item">
        <div>
          <strong>PBI Planificación Logística</strong>
          <div class="meta">KPIs de staff, posiciones y equipos · Histórico</div>
          <div class="meta">Ocupación de centros</div>
          <div class="meta">Selección</div>
          <div class="meta">Pago de teletrabajo y reclamaciones</div>
          <div class="meta">Organigrama</div>
        </div>
        <a class="btn" href="#" onclick="alert('Placeholder: PBI Logística'); return false;">
          <span class="material-symbols-rounded">monitoring</span> Abrir panel
        </a>
      </div>
      <div class="list-item">
        <div>
          <strong>Organigrama</strong>
          <div class="meta">Visualización estructural y reporting asociado</div>
        </div>
        <a class="btn" href="#" onclick="alert('Placeholder: Organigrama'); return false;">
          <span class="material-symbols-rounded">account_tree</span> Ver
        </a>
      </div>
      <div class="list-item">
        <div>
          <strong>Reserva Salas de Formación</strong>
          <div class="meta">Calendario centralizado de salas · Reservas online · Logs de accesos y cambios</div>
        </div>
        <a class="btn" href="#" onclick="alert('Placeholder: Reserva Salas'); return false;">
          <span class="material-symbols-rounded">event</span> Ver calendario
        </a>
      </div>
    </div>
  </div>
</div>
<!-- Modal Reclamaciones: imagen desde Drive -->
<div id="modalReclamaciones" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:1000; align-items:center; justify-content:center;">
  <div style="background:#fff; padding:20px; border-radius:12px; max-width:95%; max-height:90%; overflow:auto; position:relative; box-shadow:0 10px 30px rgba(0,0,0,.25);">
    <button id="closeModalReclamaciones" aria-label="Cerrar" style="position:absolute; top:10px; right:12px; border:none; background:transparent; font-size:26px; cursor:pointer; line-height:1">×</button>
    <img src="https://drive.google.com/uc?export=view&id=1r0iUNu5yyCsd9EIKimK3tId8Bzz1SwBn" alt="Flujo Reclamaciones de nómina – Pago TT" style="max-width:100%; height:auto; border-radius:8px; display:block;">
  </div>
</div>
<script>
  (function(){
    const btn = document.getElementById('btnReclamaciones');
    const modal = document.getElementById('modalReclamaciones');
    const closeBtn = document.getElementById('closeModalReclamaciones');

    if (btn && modal && closeBtn) {
      btn.addEventListener('click', function(e){
        e.preventDefault();
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      });

      function closeModal(){
        modal.style.display = 'none';
        document.body.style.overflow = '';
      }
      closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', function(e){ if (e.target === modal) closeModal(); });
      document.addEventListener('keydown', function(e){ if (e.key === 'Escape') closeModal(); });
    }
  })();
</script>